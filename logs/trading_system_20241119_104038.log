2024-11-19 10:40:38,295 - trading_system - INFO - logger.py:71 - 日志系统初始化完成
2024-11-19 10:40:38,296 - trading_system - INFO - logger.py:72 - 日志文件路径: logs
2024-11-19 10:40:38,296 - trading_system - INFO - system.py:43 - 尝试加载配置文件: D:\vscode\data_parse\trading_system\config\config.ini
2024-11-19 10:40:38,297 - trading_system - INFO - system.py:58 -   host: localhost
2024-11-19 10:40:38,298 - trading_system - INFO - system.py:58 -   port: 3306
2024-11-19 10:40:38,298 - trading_system - INFO - system.py:58 -   database: data_parse
2024-11-19 10:40:38,309 - trading_system - INFO - system.py:58 -   user: root
2024-11-19 10:40:38,309 - trading_system - INFO - system.py:58 -   password: 123456
2024-11-19 10:40:38,310 - trading_system - INFO - system.py:58 -   base_dir: output
2024-11-19 10:40:38,310 - trading_system - INFO - system.py:58 -   charts_dir: output/charts
2024-11-19 10:40:38,311 - trading_system - INFO - system.py:58 -   logs_dir: logs
2024-11-19 10:40:38,311 - trading_system - INFO - system.py:58 -   default_start_date: 2024-01-01
2024-11-19 10:40:38,311 - trading_system - INFO - system.py:58 -   default_end_date: 2024-07-01
2024-11-19 10:40:38,311 - trading_system - INFO - system.py:58 -   morning_peak_hours: 8,9,10,11,12
2024-11-19 10:40:38,312 - trading_system - INFO - system.py:58 -   evening_peak_hours: 17,18,19,20,21
2024-11-19 10:40:38,312 - trading_system - INFO - system.py:58 -   valley_hours: 0,1,2,3,4,5,6,22,23
2024-11-19 10:40:38,312 - trading_system - INFO - system.py:58 -   flat_hours: 13,14,15,16
2024-11-19 10:40:38,312 - trading_system - INFO - system.py:58 -   default_timeframe: 1d
2024-11-19 10:40:38,312 - trading_system - INFO - system.py:58 -   windows: 24,48,72,168
2024-11-19 10:40:38,313 - trading_system - INFO - system.py:58 -   dpi: 300
2024-11-19 10:40:38,313 - trading_system - INFO - system.py:58 -   figure_width: 12
2024-11-19 10:40:38,313 - trading_system - INFO - system.py:58 -   figure_height: 8
2024-11-19 10:40:38,313 - trading_system - INFO - system.py:58 -   theme: plotly_dark
2024-11-19 10:40:38,314 - trading_system - INFO - system.py:58 -   output_dir: output/charts
2024-11-19 10:40:38,314 - trading_system - INFO - system.py:58 -   initial_capital: 1000000
2024-11-19 10:40:38,314 - trading_system - INFO - system.py:58 -   commission_rate: 0.0003
2024-11-19 10:40:38,315 - trading_system - INFO - system.py:58 -   slippage: 0.0001
2024-11-19 10:40:38,315 - trading_system - INFO - system.py:58 -   spring_months: 3,4,5
2024-11-19 10:40:38,315 - trading_system - INFO - system.py:58 -   summer_months: 6,7,8
2024-11-19 10:40:38,315 - trading_system - INFO - system.py:58 -   autumn_months: 9,10,11
2024-11-19 10:40:38,316 - trading_system - INFO - system.py:58 -   winter_months: 12,1,2
2024-11-19 10:40:38,316 - trading_system - INFO - system.py:58 -   deep_valley_hours: 0,1,2,3,4,5
2024-11-19 10:40:38,316 - trading_system - INFO - system.py:58 -   valley_hours: 10,14
2024-11-19 10:40:38,316 - trading_system - INFO - system.py:58 -   flat_hours: 6,7,8,9
2024-11-19 10:40:38,316 - trading_system - INFO - system.py:58 -   peak_hours: 19,20
2024-11-19 10:40:38,317 - trading_system - INFO - system.py:58 -   deep_peak_hours: 17,18
2024-11-19 10:40:38,317 - trading_system - INFO - system.py:58 -   cache_size: 128
2024-11-19 10:40:38,317 - trading_system - INFO - system.py:58 -   enable_data_cache: true
2024-11-19 10:40:38,317 - trading_system - INFO - system.py:58 -   cache_ttl: 3600
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   parallel_workers: 4
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   enable_performance_tracking: true
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   price_min_threshold: 0
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   price_max_threshold: 10000
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   volatility_warning_threshold: 0.5
2024-11-19 10:40:38,318 - trading_system - INFO - system.py:58 -   enable_metrics_logging: true
2024-11-19 10:40:38,319 - trading_system - INFO - system.py:58 -   metrics_retention_days: 30
2024-11-19 10:40:38,319 - trading_system - INFO - system.py:58 -   max_price_outlier_std: 3.0
2024-11-19 10:40:38,319 - trading_system - INFO - system.py:58 -   min_daily_records: 20
2024-11-19 10:40:38,319 - trading_system - INFO - system.py:58 -   allow_missing_dates: false
2024-11-19 10:40:38,320 - trading_system - INFO - system.py:58 -   fix_hour_anomalies: true
2024-11-19 10:40:38,320 - trading_system - INFO - system.py:58 -   lookback_days: 5
2024-11-19 10:40:38,320 - trading_system - INFO - system.py:58 -   entry_threshold: 0.02
2024-11-19 10:40:38,320 - trading_system - INFO - system.py:58 -   exit_threshold: 0.01
2024-11-19 10:40:38,321 - trading_system - INFO - system.py:58 -   stop_loss: 0.03
2024-11-19 10:40:38,321 - trading_system - INFO - system.py:58 -   take_profit: 0.05
2024-11-19 10:40:38,328 - trading_system - INFO - db_manager.py:100 - 正在查询从 2024-01-01 到 2024-07-01 的价格数据
2024-11-19 10:40:38,348 - trading_system - INFO - db_manager.py:37 - 成功创建数据库引擎，连接到: localhost:3306
2024-11-19 10:40:38,684 - trading_system - INFO - db_manager.py:114 - 原始数据前5行:
   trade_date  trade_hour   price  data_type
0  2024-01-01           0  403.93          2
1  2024-01-01           1  387.77          2
2  2024-01-01           2  371.25          2
3  2024-01-01           3  372.40          2
4  2024-01-01           4  383.11          2
2024-11-19 10:40:38,686 - trading_system - INFO - db_manager.py:115 - 数据类型:
trade_date     object
trade_hour      int64
price         float64
data_type       int64
dtype: object
2024-11-19 10:40:38,691 - trading_system - INFO - db_manager.py:124 - 
            数据统计信息:
            - 总记录数: 4368
            - 日期范围: 2024-01-01 00:00:00 到 2024-06-30 00:00:00
            - 小时范围: 0 到 23
            - 价格列名: Index(['trade_date', 'trade_hour', 'price', 'data_type'], dtype='object')
            - 价格数据:
              - 非空值数: 4368
              - 空值数: 0
              - 均值: 284.77
              - 标准差: 215.87
              - 中位数: 341.14
              - 最小值: -100.00
              - 最大值: 1424.31
            
2024-11-19 10:40:38,693 - trading_system - INFO - system.py:102 - 获取的数据列: ['trade_date', 'trade_hour', 'price', 'data_type']
2024-11-19 10:40:38,710 - trading_system - INFO - data_processor.py:77 - 数据处理完成，最终列: ['trade_date', 'trade_hour', 'price', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility']
2024-11-19 10:40:38,711 - trading_system - INFO - system.py:110 - 处理后的数据列: ['trade_date', 'trade_hour', 'price', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility']
2024-11-19 10:40:38,711 - trading_system - INFO - system.py:122 - 验证原始数据...
2024-11-19 10:40:38,711 - trading_system - INFO - system.py:123 - 数据形状: (4368, 4)
2024-11-19 10:40:38,712 - trading_system - INFO - system.py:124 - 数据: ['trade_date', 'trade_hour', 'price', 'data_type']
2024-11-19 10:40:38,719 - trading_system - INFO - system.py:145 - 已添加工作日标记
2024-11-19 10:40:38,719 - trading_system - INFO - system.py:155 - 开始处理数据...
2024-11-19 10:40:38,735 - trading_system - INFO - data_processor.py:77 - 数据处理完成，最终列: ['trade_date', 'trade_hour', 'price', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility']
2024-11-19 10:40:38,736 - trading_system - INFO - system.py:166 - 转换索引为datetime类型...
2024-11-19 10:40:38,744 - trading_system - INFO - system.py:178 - 索引转换完成
2024-11-19 10:40:38,744 - trading_system - INFO - system.py:179 - 处理后数据列: ['trade_date', 'trade_hour', 'price', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility']
2024-11-19 10:40:38,763 - trading_system - WARNING - system.py:223 - 以下列存在空值: ['supply_pressure', 'demand_pressure', 'supply_pressure_ma', 'demand_pressure_ma']
2024-11-19 10:40:38,764 - trading_system - INFO - system.py:227 - 已填充 supply_pressure 列的空值
2024-11-19 10:40:38,765 - trading_system - INFO - system.py:227 - 已填充 demand_pressure 列的空值
2024-11-19 10:40:38,766 - trading_system - INFO - system.py:227 - 已填充 supply_pressure_ma 列的空值
2024-11-19 10:40:38,767 - trading_system - INFO - system.py:227 - 已填充 demand_pressure_ma 列的空值
2024-11-19 10:40:38,767 - trading_system - INFO - system.py:233 - 开始生成所有分析图表...
2024-11-19 10:40:38,768 - trading_system - INFO - system.py:236 - 生成价格分析图表...
2024-11-19 10:40:39,520 - trading_system - INFO - system.py:240 - 生成时间模式图表...
2024-11-19 10:40:39,646 - trading_system - INFO - system.py:244 - 生成特征分析图表...
2024-11-19 10:40:40,245 - trading_system - INFO - system.py:248 - 生成回归分析图表...
2024-11-19 10:40:40,245 - trading_system - INFO - regression_charts.py:25 - Feature Columns: ['trade_date', 'trade_hour', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility', 'dayofweek', 'supply_pressure', 'demand_pressure', 'supply_pressure_ma', 'demand_pressure_ma', 'is_morning_peak', 'is_evening_peak', 'is_valley']
2024-11-19 10:40:40,247 - trading_system - INFO - regression_charts.py:26 - Data Types:
trade_date             object
trade_hour              int32
data_type               int32
is_workday               bool
log_price             float64
returns               float64
hour                    int32
day                     int32
weekday                 int32
month                   int32
hour_sin              float64
hour_cos              float64
price_ma24            float64
price_volatility      float64
dayofweek               int32
supply_pressure       float64
demand_pressure       float64
supply_pressure_ma    float64
demand_pressure_ma    float64
is_morning_peak         int32
is_evening_peak         int32
is_valley               int32
dtype: object
2024-11-19 10:40:40,251 - trading_system - INFO - regression_charts.py:32 - Filtered Feature Columns: ['trade_hour', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility', 'dayofweek', 'supply_pressure', 'demand_pressure', 'supply_pressure_ma', 'demand_pressure_ma', 'is_morning_peak', 'is_evening_peak', 'is_valley']
2024-11-19 10:40:40,998 - trading_system - INFO - regression_charts.py:180 - 开始训练模型...
2024-11-19 10:40:41,845 - trading_system - INFO - regression_charts.py:184 - 模型训练完成
2024-11-19 10:40:57,947 - trading_system - INFO - regression_charts.py:192 - 特征重要性: is_valley             0.000000
dayofweek             0.000000
is_evening_peak       0.000000
hour                  0.000000
is_morning_peak       0.000039
is_workday            0.000070
hour_sin              0.000253
trade_hour            0.000428
weekday               0.000649
month                 0.000913
price_volatility      0.004342
day                   0.004451
data_type             0.008770
demand_pressure_ma    0.009272
price_ma24            0.014629
supply_pressure_ma    0.016112
hour_cos              0.028057
supply_pressure       0.039307
demand_pressure       0.073878
returns               0.091144
log_price             1.309884
dtype: float64
2024-11-19 10:40:58,012 - trading_system - INFO - system.py:252 - 生成供需分析图表...
2024-11-19 10:40:59,229 - trading_system - INFO - system.py:256 - 生成工作日分析图表...
2024-11-19 10:40:59,232 - trading_system - INFO - system.py:260 - 生成峰谷分析图表...
2024-11-19 10:40:59,236 - trading_system - INFO - time_charts.py:262 - 处理前的trade_date列样本: datetime
2024-01-01 00:00:00    2024-01-01
2024-01-01 01:00:00    2024-01-01
2024-01-01 02:00:00    2024-01-01
2024-01-01 03:00:00    2024-01-01
2024-01-01 04:00:00    2024-01-01
Name: trade_date, dtype: object
2024-11-19 10:40:59,239 - trading_system - INFO - time_charts.py:275 - 处理后的数据列: ['trade_date', 'trade_hour', 'price', 'data_type', 'is_workday', 'log_price', 'returns', 'hour', 'day', 'weekday', 'month', 'hour_sin', 'hour_cos', 'price_ma24', 'price_volatility', 'dayofweek', 'supply_pressure', 'demand_pressure', 'supply_pressure_ma', 'demand_pressure_ma', 'is_morning_peak', 'is_evening_peak', 'is_valley', 'supply_demand_ratio', 'date']
2024-11-19 10:40:59,530 - trading_system - INFO - system.py:264 - 生成预测分析图表...
2024-11-19 10:40:59,558 - trading_system - INFO - regression_charts.py:287 - 数据中没有预测值，使用简单模型生成预测...
2024-11-19 10:40:59,563 - trading_system - WARNING - regression_charts.py:311 - 使用模型生成预测值失败: Input X contains NaN.
LinearRegression does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values，将使用移动平均...
2024-11-19 10:41:00,344 - trading_system - INFO - system.py:268 - 生成导航页面...
2024-11-19 10:41:00,349 - trading_system - INFO - navigation.py:24 - 导航页面已生成: trading_system\output\index.html
2024-11-19 10:41:00,349 - trading_system - INFO - system.py:271 - 导航页面已生成: trading_system\output\index.html
2024-11-19 10:41:00,350 - trading_system - INFO - system.py:276 - 导航页面文件已确认存在
2024-11-19 10:41:00,351 - trading_system - INFO - system.py:279 - 
=== 已生成的分析文件 ===
2024-11-19 10:41:00,352 - trading_system - INFO - system.py:283 - - index.html
2024-11-19 10:41:00,353 - trading_system - INFO - system.py:283 - - analysis\supply_demand_dashboard.html
2024-11-19 10:41:00,353 - trading_system - INFO - system.py:283 - - features\feature_analysis.html
2024-11-19 10:41:00,354 - trading_system - INFO - system.py:283 - - features\feature_correlation.html
2024-11-19 10:41:00,355 - trading_system - INFO - system.py:283 - - features\hourly_price_distribution.html
2024-11-19 10:41:00,355 - trading_system - INFO - system.py:283 - - peak_valley\peak_valley_analysis.html
2024-11-19 10:41:00,355 - trading_system - INFO - system.py:283 - - peak_valley\peak_valley_distribution.html
2024-11-19 10:41:00,356 - trading_system - INFO - system.py:283 - - peak_valley\peak_valley_pattern.html
2024-11-19 10:41:00,356 - trading_system - INFO - system.py:283 - - peak_valley\price_transition.html
2024-11-19 10:41:00,357 - trading_system - INFO - system.py:283 - - predictions\prediction_analysis.html
2024-11-19 10:41:00,358 - trading_system - INFO - system.py:283 - - price_analysis\price_distribution.html
2024-11-19 10:41:00,358 - trading_system - INFO - system.py:283 - - price_analysis\price_trend.html
2024-11-19 10:41:00,358 - trading_system - INFO - system.py:283 - - price_analysis\price_trend_analysis.html
2024-11-19 10:41:00,359 - trading_system - INFO - system.py:283 - - price_analysis\price_volatility.html
2024-11-19 10:41:00,359 - trading_system - INFO - system.py:283 - - regression_analysis\feature_importance.html
2024-11-19 10:41:00,359 - trading_system - INFO - system.py:283 - - regression_analysis\price_factors_regression.html
2024-11-19 10:41:00,360 - trading_system - INFO - system.py:283 - - regression_analysis\regression_diagnostics.html
2024-11-19 10:41:00,361 - trading_system - INFO - system.py:283 - - supply_demand\price_elasticity.html
2024-11-19 10:41:00,362 - trading_system - INFO - system.py:283 - - supply_demand\supply_demand_balance.html
2024-11-19 10:41:00,363 - trading_system - INFO - system.py:283 - - supply_demand\supply_demand_dashboard.html
2024-11-19 10:41:00,363 - trading_system - INFO - system.py:283 - - supply_demand\supply_demand_impact.html
2024-11-19 10:41:00,363 - trading_system - INFO - system.py:283 - - time_patterns\daily_pattern.html
2024-11-19 10:41:00,364 - trading_system - INFO - system.py:283 - - time_patterns\intraday_pattern.html
2024-11-19 10:41:00,364 - trading_system - INFO - system.py:283 - - time_patterns\seasonal_pattern.html
2024-11-19 10:41:00,364 - trading_system - INFO - system.py:283 - - time_patterns\time_patterns.html
2024-11-19 10:41:00,364 - trading_system - INFO - system.py:283 - - time_patterns\weekly_pattern.html
2024-11-19 10:41:00,364 - trading_system - INFO - system.py:283 - - time_patterns\workday_comparison.html
2024-11-19 10:41:00,365 - trading_system - INFO - system.py:283 - - workday_analysis\holiday_effect.html
2024-11-19 10:41:00,366 - trading_system - INFO - system.py:283 - - workday_analysis\workday_analysis.html
2024-11-19 10:41:00,366 - trading_system - INFO - system.py:283 - - workday_analysis\workday_comparison.html
2024-11-19 10:41:00,367 - trading_system - INFO - system.py:283 - - workday_analysis\workday_pattern.html
